FROM cern/c8-base:latest AS rhel8

RUN yum install -y wget perl gcc make tree elfutils-libelf-devel; 
RUN yum groupinstall -y  "Development Tools"; 
RUN mkdir /root/headers
RUN cd /root/headers; wget -q -c -r -np -nd -nH -A 'kernel*devel*x86_64.rpm' 'http://mirrors.coreix.net/elrepo-archive-archive/kernel/el8/x86_64/RPMS/'
RUN rpm --force -ivh /root/headers/*.rpm || true

<<<<<<< HEAD
<<<<<<< HEAD
ADD . /elkeid
WORKDIR /elkeid/driver
=======
ADD . /elkeid_driver
WORKDIR /elkeid_driver
>>>>>>> 707aed2 (update driver auto_build)
=======
ADD . /elkeid
WORKDIR /elkeid/driver
>>>>>>> 6fc7695 (fix docker path)
RUN bash ./batch_compile.sh
RUN rm -rf /root/headers/*

